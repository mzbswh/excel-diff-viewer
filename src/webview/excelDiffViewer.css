/* Excel Diff Viewer 样式文件 */

/* 基础变量 - Light Theme */
:root {
	--diff-added-color: #4caf50;
	--diff-removed-color: #f44336;
	--diff-modified-color: #ff9800;
	--diff-unchanged-color: transparent;
	--diff-border-color: #e0e0e0;
	--diff-hover-color: #f5f5f5;
	
	/* 主题颜色 */
	--primary-color: #007acc;
	--secondary-color: #6c757d;
	--success-color: #28a745;
	--danger-color: #dc3545;
	--warning-color: #ffc107;
	--info-color: #17a2b8;
	
	/* 背景颜色 */
	--bg-primary: #ffffff;
	--bg-secondary: #f8f9fa;
	--bg-tertiary: #e9ecef;
	--bg-hover: #f1f3f4;
	
	/* 文字颜色 */
	--text-primary: #212529;
	--text-secondary: #6c757d;
	--text-muted: #adb5bd;
	
	/* 边框颜色 */
	--border-color: #dee2e6;
	--border-light: #e9ecef;
	
	/* 阴影 */
	--shadow-sm: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
	--shadow-md: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
	--shadow-lg: 0 1rem 3rem rgba(0, 0, 0, 0.175);
	
	/* 圆角 */
	--border-radius-sm: 0.25rem;
	--border-radius-md: 0.375rem;
	--border-radius-lg: 0.5rem;
	
	/* 间距 */
	--spacing-xs: 0.25rem;
	--spacing-sm: 0.5rem;
	--spacing-md: 1rem;
	--spacing-lg: 1.5rem;
	--spacing-xl: 3rem;
}

/* Dark Theme */
[data-theme="dark"] {
	--bg-primary: #1e1e1e;
	--bg-secondary: #2d2d30;
	--bg-tertiary: #3c3c3c;
	--bg-hover: #404040;
	
	--text-primary: #ffffff;
	--text-secondary: #cccccc;
	--text-muted: #999999;
	
	--border-color: #3c3c3c;
	--border-light: #404040;
	
	--diff-added-color: #4caf50;
	--diff-removed-color: #f44336;
	--diff-modified-color: #ff9800;
}

/* 主容器 */
#excel-diff-container {
	height: 100vh;
	display: flex;
	flex-direction: column;
	background-color: var(--bg-primary);
	color: var(--text-primary);
	/* 性能优化 */
	will-change: auto;
	contain: layout style;
}

/* 工具栏 */
.toolbar {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: var(--spacing-sm) var(--spacing-md);
	background-color: var(--bg-secondary);
	border-bottom: 1px solid var(--border-color);
	box-shadow: var(--shadow-sm);
	z-index: 1000;
}

.toolbar-left {
	display: flex;
	align-items: center;
	gap: var(--spacing-md);
}

.logo {
	display: flex;
	align-items: center;
	gap: var(--spacing-sm);
	font-weight: 600;
	font-size: 1.1rem;
	color: var(--primary-color);
}

.logo-icon {
	font-size: 1.2rem;
}

.toolbar-center {
	display: flex;
	align-items: center;
	gap: var(--spacing-md);
}

.diff-mode-selector {
	display: flex;
	align-items: center;
	gap: var(--spacing-sm);
}

.diff-mode-selector label {
	font-size: 0.9rem;
	color: var(--text-secondary);
	font-weight: 500;
}

.mode-select {
	padding: var(--spacing-xs) var(--spacing-sm);
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius-sm);
	background-color: var(--bg-primary);
	color: var(--text-primary);
	font-size: 0.9rem;
	cursor: pointer;
}

.mode-select:focus {
	outline: none;
	border-color: var(--primary-color);
	box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.2);
}

.toolbar-right {
	display: flex;
	align-items: center;
	gap: var(--spacing-sm);
}

.theme-btn,
.settings-btn {
	width: 32px;
	height: 32px;
	border: none;
	border-radius: var(--border-radius-sm);
	background-color: transparent;
	color: var(--text-secondary);
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 1.1rem;
}

.theme-btn:hover,
.settings-btn:hover {
	background-color: var(--bg-hover);
	color: var(--text-primary);
}

/* 设置面板 */
.settings-panel {
	position: fixed;
	top: 60px;
	right: var(--spacing-md);
	width: 300px;
	background-color: var(--bg-primary);
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius-md);
	box-shadow: var(--shadow-lg);
	z-index: 1001;
}

.settings-content {
	padding: var(--spacing-md);
}

.settings-content h3 {
	margin: 0 0 var(--spacing-md) 0;
	font-size: 1.1rem;
	color: var(--text-primary);
}

.setting-group {
	margin-bottom: var(--spacing-md);
}

.setting-group label {
	display: block;
	margin-bottom: var(--spacing-xs);
	font-size: 0.9rem;
	font-weight: 500;
	color: var(--text-secondary);
}

.setting-select {
	width: 100%;
	padding: var(--spacing-xs) var(--spacing-sm);
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius-sm);
	background-color: var(--bg-primary);
	color: var(--text-primary);
	font-size: 0.9rem;
	cursor: pointer;
}

.setting-select:focus {
	outline: none;
	border-color: var(--primary-color);
	box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.2);
}

.setting-actions {
	display: flex;
	gap: var(--spacing-sm);
	justify-content: flex-end;
	margin-top: var(--spacing-lg);
}

/* 文件选择区域 */
.file-selection {
	display: flex;
	flex-direction: column;
	height: 100vh;
	padding: 20px;
}

.file-selection-header {
	text-align: center;
	margin-bottom: 30px;
}

.file-selection-header h2 {
	font-size: 24px;
	font-weight: 600;
	margin-bottom: 8px;
}

.file-selection-header p {
	color: var(--vscode-descriptionForeground);
	font-size: 14px;
}

.file-selection-content {
	display: flex;
	gap: 20px;
	flex: 1;
	min-height: 0;
}

.file-panel {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	border: 2px dashed var(--vscode-input-border);
	border-radius: 8px;
	padding: 30px 20px;
	text-align: center;
	cursor: pointer;
	position: relative;
}

.file-panel:hover {
	border-color: var(--vscode-focusBorder);
	background-color: var(--vscode-input-background);
}

.file-panel.has-file {
	border-color: var(--vscode-inputValidation-infoBorder);
	background-color: var(--vscode-inputValidation-infoBackground);
}

.file-panel-icon {
	font-size: 48px;
	margin-bottom: 16px;
	opacity: 0.7;
}

.file-panel-label {
	font-size: 16px;
	font-weight: 600;
	margin-bottom: 8px;
}

.file-panel-description {
	color: var(--vscode-descriptionForeground);
	font-size: 12px;
	margin-bottom: 16px;
}

.file-panel-info {
	background-color: var(--vscode-badge-background);
	border-radius: 4px;
	padding: 12px;
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
	font-size: 12px;
	word-break: break-all;
	text-align: left;
	width: 100%;
	margin-bottom: 16px;
}

.file-name {
	font-weight: 600;
	margin-bottom: 4px;
	color: var(--vscode-foreground);
}

.file-path {
	color: var(--vscode-descriptionForeground);
}

.file-select-btn {
	padding: 8px 16px;
	border: 1px solid var(--vscode-button-border);
	border-radius: 4px;
	background-color: var(--vscode-button-background);
	color: var(--vscode-button-foreground);
	font-size: 12px;
	font-weight: 600;
	cursor: pointer;
}

.file-select-btn:hover {
	background-color: var(--vscode-button-hoverBackground);
}

.file-selection-controls {
	display: flex;
	justify-content: center;
	gap: 12px;
	margin-top: 30px;
}

.diff-controls {
	display: flex;
	gap: 8px;
	margin-left: auto;
}

/* Diff 视图样式 */
.diff-view {
	height: 100%;
	overflow: hidden;
}

/* 合并视图 */
.unified-content {
	height: 100%;
	overflow: auto;
	padding: var(--spacing-md);
}

/* 分割视图 */
.split-container {
	display: flex;
	height: 100%;
}

.split-pane {
	flex: 1;
	display: flex;
	flex-direction: column;
	background-color: var(--bg-primary);
}

.split-divider {
	width: 4px;
	background-color: var(--border-color);
	cursor: col-resize;
	position: relative;
}

.split-divider:hover {
	background-color: var(--primary-color);
}

.split-divider::before {
	content: '';
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	width: 2px;
	height: 20px;
	background-color: var(--text-muted);
}

.pane-header {
	padding: var(--spacing-sm) var(--spacing-md);
	background-color: var(--bg-secondary);
	border-bottom: 1px solid var(--border-color);
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.pane-title {
	font-weight: 600;
	color: var(--text-primary);
}

.pane-filename {
	font-size: 0.9rem;
	color: var(--text-secondary);
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

.pane-content {
	flex: 1;
	overflow: auto;
	padding: var(--spacing-md);
}

/* 并排视图 */
.side-by-side-container {
	display: flex;
	height: 100%;
}

.side-pane {
	flex: 1;
	display: flex;
	flex-direction: column;
	background-color: var(--bg-primary);
	border-right: 1px solid var(--border-color);
}

.side-pane:last-child {
	border-right: none;
}

.side-header {
	padding: var(--spacing-sm) var(--spacing-md);
	background-color: var(--bg-secondary);
	border-bottom: 1px solid var(--border-color);
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.side-title {
	font-weight: 600;
	color: var(--text-primary);
}

.side-filename {
	font-size: 0.9rem;
	color: var(--text-secondary);
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

.side-content {
	flex: 1;
	overflow: auto;
	padding: var(--spacing-md);
}

/* 差异表格样式 */
.diff-table {
	width: 100%;
	border-collapse: collapse;
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
	font-size: 0.9rem;
}

.diff-table th,
.diff-table td {
	padding: var(--spacing-xs) var(--spacing-sm);
	text-align: left;
	border: 1px solid var(--border-light);
}

.diff-table th {
	background-color: var(--bg-secondary);
	font-weight: 600;
	color: var(--text-primary);
	position: sticky;
	top: 0;
	z-index: 10;
}

.diff-cell {
	position: relative;
}

.diff-cell.added {
	background-color: rgba(76, 175, 80, 0.1);
	border-left: 3px solid var(--diff-added-color);
}

.diff-cell.removed {
	background-color: rgba(244, 67, 54, 0.1);
	border-left: 3px solid var(--diff-removed-color);
}

.diff-cell.modified {
	background-color: rgba(255, 152, 0, 0.1);
	border-left: 3px solid var(--diff-modified-color);
}

.diff-cell.highlighted {
	background-color: rgba(0, 122, 204, 0.2);
	box-shadow: 0 0 0 2px var(--primary-color);
}

/* 加载状态 */
.loading {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	height: 100%;
	gap: 16px;
}

.loading-spinner {
	width: 40px;
	height: 40px;
	border: 4px solid var(--vscode-progressBar-background);
	border-top: 4px solid var(--vscode-progressBar-foreground);
	border-radius: 50%;
	animation: spin 1s linear infinite;
}

@keyframes spin {
	0% { transform: rotate(0deg); }
	100% { transform: rotate(360deg); }
}

.loading-text {
	color: var(--vscode-descriptionForeground);
	font-size: 14px;
}

/* 错误状态 */
.error {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	height: 100%;
	gap: 16px;
	text-align: center;
	padding: 20px;
}

.error-icon {
	font-size: 48px;
	opacity: 0.7;
}

.error-message {
	color: var(--vscode-errorForeground);
	font-size: 16px;
	font-weight: 500;
}

/* 差异内容 */
.diff-content {
	display: flex;
	flex-direction: column;
	height: 100%;
	overflow: hidden;
}

/* 头部信息 */
.diff-header {
	background-color: var(--vscode-panel-background);
	border-bottom: 1px solid var(--vscode-panel-border);
	padding: 16px;
	flex-shrink: 0;
}

.file-info {
	display: flex;
	gap: 24px;
	margin-bottom: 16px;
}

.file-old, .file-new {
	flex: 1;
	min-width: 0;
}

.file-label {
	font-weight: 600;
	margin-right: 8px;
	color: var(--vscode-foreground);
}

.file-path {
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
	font-size: 12px;
	color: var(--vscode-descriptionForeground);
	word-break: break-all;
}

.diff-summary {
	display: flex;
	gap: 20px;
	flex-wrap: wrap;
}

.summary-item {
	display: flex;
	align-items: center;
	gap: 6px;
	padding: 4px 8px;
	border-radius: 4px;
	background-color: var(--vscode-badge-background);
}

.summary-label {
	font-size: 12px;
	color: var(--vscode-descriptionForeground);
}

.summary-value {
	font-weight: 600;
	font-size: 14px;
}

.summary-item.added .summary-value {
	color: var(--diff-added-color);
}

.summary-item.removed .summary-value {
	color: var(--diff-removed-color);
}

.summary-item.modified .summary-value {
	color: var(--diff-modified-color);
}

/* 标签页 */
.diff-tabs {
	flex: 1;
	display: flex;
	flex-direction: column;
	overflow: hidden;
}

.tab-list {
	display: flex;
	background-color: var(--vscode-tab-inactiveBackground);
	border-bottom: 1px solid var(--vscode-tab-border);
	flex-shrink: 0;
	overflow-x: auto;
}

.tab-item {
	padding: 10px 16px;
	cursor: pointer;
	border-bottom: 2px solid transparent;
	white-space: nowrap;
	display: flex;
	align-items: center;
	gap: 8px;
}

.tab-item:hover {
	background-color: var(--vscode-tab-hoverBackground);
}

.tab-item.active {
	background-color: var(--vscode-tab-activeBackground);
	border-bottom-color: var(--vscode-tab-activeBorder);
}

.tab-item .tab-badge {
	font-size: 10px;
	padding: 2px 6px;
	border-radius: 10px;
	font-weight: 600;
}

.tab-item.added .tab-badge {
	background-color: var(--diff-added-color);
	color: white;
}

.tab-item.removed .tab-badge {
	background-color: var(--diff-removed-color);
	color: white;
}

.tab-item.modified .tab-badge {
	background-color: var(--diff-modified-color);
	color: white;
}

.tab-item.unchanged .tab-badge {
	background-color: var(--vscode-badge-background);
	color: var(--vscode-badge-foreground);
}

.tab-content {
	flex: 1;
	overflow: auto;
	padding: 16px;
}

/* 表格样式 */
.diff-table {
	width: 100%;
	border-collapse: collapse;
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
	font-size: 12px;
	background-color: var(--vscode-editor-background);
}

.diff-table th,
.diff-table td {
	border: 1px solid var(--vscode-table-border);
	padding: 6px 8px;
	text-align: left;
	vertical-align: top;
	position: relative;
}

.diff-table th {
	background-color: var(--vscode-table-headerBackground);
	font-weight: 600;
	position: sticky;
	top: 0;
	z-index: 10;
	text-align: center;
}

.diff-table td {
	background-color: var(--vscode-table-cellBackground);
}

.diff-table .row-number {
	background-color: var(--vscode-editorLineNumber-foreground);
	color: var(--vscode-editorLineNumber-foreground);
	text-align: center;
	font-weight: 600;
	width: 60px;
	min-width: 60px;
	user-select: none;
}

.diff-table tr:hover td {
	background-color: var(--diff-hover-color);
}

.diff-table tr:hover .cell-added {
	background-color: rgba(76, 175, 80, 0.3) !important;
}

.diff-table tr:hover .cell-removed {
	background-color: rgba(244, 67, 54, 0.3) !important;
}

.diff-table tr:hover .cell-modified {
	background-color: rgba(255, 152, 0, 0.3) !important;
}

/* 差异高亮 */
.cell-added {
	background-color: rgba(76, 175, 80, 0.2) !important;
	border-left: 3px solid var(--diff-added-color) !important;
}

.cell-removed {
	background-color: rgba(244, 67, 54, 0.2) !important;
	border-left: 3px solid var(--diff-removed-color) !important;
}

.cell-modified {
	background-color: rgba(255, 152, 0, 0.2) !important;
	border-left: 3px solid var(--diff-modified-color) !important;
}

.cell-unchanged {
	background-color: var(--vscode-table-cellBackground);
}

/* 单元格内容 */
.cell-content {
	position: relative;
	min-height: 20px;
}

.cell-old-value {
	color: var(--diff-removed-color);
	text-decoration: line-through;
	margin-bottom: 4px;
}

.cell-new-value {
	color: var(--diff-added-color);
	font-weight: 500;
}

.cell-value {
	color: var(--vscode-foreground);
}

/* 导航按钮 */
.navigation-controls {
	position: fixed;
	bottom: 20px;
	right: 20px;
	display: flex;
	gap: 8px;
	z-index: 100;
}

.nav-button {
	width: 40px;
	height: 40px;
	border: none;
	border-radius: 50%;
	background-color: var(--vscode-button-background);
	color: var(--vscode-button-foreground);
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 16px;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.nav-button:hover {
	background-color: var(--vscode-button-hoverBackground);
}

.nav-button:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* 工具类 */
.hidden {
	display: none !important;
}

.text-center {
	text-align: center;
}

.text-right {
	text-align: right;
}

.font-mono {
	font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* 响应式设计 */
@media (max-width: 768px) {
	.file-info {
		flex-direction: column;
		gap: 8px;
	}

	.diff-summary {
		flex-direction: column;
		gap: 8px;
	}

	.tab-list {
		flex-wrap: wrap;
	}

	.tab-item {
		padding: 8px 12px;
		font-size: 12px;
	}

	.diff-table {
		font-size: 10px;
	}

	.diff-table th,
	.diff-table td {
		padding: 4px 6px;
	}

	.navigation-controls {
		bottom: 10px;
		right: 10px;
	}

	.nav-button {
		width: 36px;
		height: 36px;
		font-size: 14px;
	}
}

/* 滚动条样式 */
.diff-table::-webkit-scrollbar,
.tab-content::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

.diff-table::-webkit-scrollbar-track,
.tab-content::-webkit-scrollbar-track {
	background: var(--vscode-scrollbarSlider-background);
}

.diff-table::-webkit-scrollbar-thumb,
.tab-content::-webkit-scrollbar-thumb {
	background: var(--vscode-scrollbarSlider-hoverBackground);
	border-radius: 4px;
}

.diff-table::-webkit-scrollbar-thumb:hover,
.tab-content::-webkit-scrollbar-thumb:hover {
	background: var(--vscode-scrollbarSlider-activeBackground);
}
