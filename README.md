# Excel Diff Viewer

一个用于对比两个 Excel 文件差异的 VS Code 扩展。

## 功能特性

- 📊 直观的文件差异对比界面
- 🎨 现代化的 UI 设计
- 🌓 支持浅色/深色/自动主题切换
- 📁 支持拖拽和文件选择两种方式
- 🔍 高亮显示添加、删除和修改的内容

## 使用方法

### 1. 打开 Excel Diff Viewer

- 使用命令面板（`Cmd+Shift+P` 或 `Ctrl+Shift+P`）
- 输入并选择 `Excel Diff Viewer: Open Excel Diff Viewer`

### 2. 选择要对比的文件

**方法一：点击选择**
1. 点击左侧"文件 A (原始)"区域
2. 在文件选择对话框中选择第一个 Excel 文件
3. 点击右侧"文件 B (新版)"区域
4. 在文件选择对话框中选择第二个 Excel 文件

**方法二：拖拽选择**
1. 将 Excel 文件拖拽到对应的文件选择区域
2. 在自动打开的文件选择对话框中确认选择该文件

### 3. 开始对比

- 选择完两个文件后，点击底部的"开始对比"按钮
- 查看差异对比结果

## 使用拖拽功能的注意事项

扩展支持两种文件选择方式：

### 推荐方式：点击选择 ✅
1. 点击文件选择区域
2. 在文件选择对话框中选择 Excel 文件
3. 文件信息会自动显示

### 拖拽方式：按住 Shift 拖拽 🖱️
1. **按住 Shift 键**
2. 将 Excel 文件拖拽到文件选择区域
3. 松开鼠标，文件会自动加载

💡 **为什么需要按 Shift？**
这是 VS Code 的设计规范：
- 普通拖拽 → 在编辑器中打开文件
- Shift + 拖拽 → 传递给扩展处理

如果不按 Shift 直接拖拽，文件会被 VS Code 的默认 Excel 查看器打开。

## 主题切换

点击右上角的主题切换按钮可以在以下模式间切换：

- 🌓 **自动模式**：跟随 VS Code 主题
- ☀️ **浅色模式**：明亮的白色主题
- 🌙 **深色模式**：舒适的暗色主题

## 支持的文件格式

- `.xlsx` - Excel 2007 及更高版本
- `.xls` - Excel 97-2003

## 常见问题

### Q: 为什么拖拽文件后还需要再次选择？

A: 由于浏览器安全限制，webview 无法直接访问拖拽文件的完整文件系统路径。拖拽操作会自动打开文件选择对话框，让您确认选择该文件。

### Q: 如何比较大型 Excel 文件？

A: 扩展支持各种大小的 Excel 文件，但对于非常大的文件（数千行），加载可能需要几秒钟时间。

## 开发

```bash
# 安装依赖
npm install

# 编译
npm run compile

# 开发模式（自动重新编译）
npm run watch

# 调试
按 F5 启动调试
```

## 许可证

MIT License

